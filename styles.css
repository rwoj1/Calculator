/* =========================================================
   THEME — White page • Light-blue cards
   Palette: 094D76, 118BD5, 0E75B3, 0D6CA6
   ========================================================= */
:root{
  /* Brand blues */
  --brand-900:#094D76;
  --brand-700:#0D6CA6;
  --brand-600:#0E75B3;
  --brand-500:#118BD5;

  /* Surfaces & text */
  --page:#ffffff;
  --card:#EDF6FB;
  --card-hover:#E6F2F9;
  --text:#0f172a;
  --muted:#4b5563;
  --border:#dbe9f5;
  --line:#e5eef6;
  --line-strong:#c9dfef;

  /* Accent */
  --accent:var(--brand-500);
}

*{box-sizing:border-box;}
html,body{
  margin:0;padding:0;
  background:var(--page);
  color:var(--text);
  font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
}

/* =========================================================
   LAYOUT & HEADINGS
   ========================================================= */
.container{max-width:1040px;margin:28px auto;padding:0 18px;}
h1{font-size:22px;margin:0 0 12px;color:var(--brand-900);}
h2{font-size:18px;margin:0 0 10px;color:var(--brand-700);}
h3{font-size:14px;margin:0 0 8px;color:var(--muted);}

/* Cards */
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:16px;
  padding:18px;
  margin:18px 0;
  box-shadow:0 10px 22px rgba(17,139,213,.06),0 2px 6px rgba(0,0,0,.03);
}
.card:hover{background:var(--card-hover);}
.card-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;}
.card-head h2,.card-head h3{position:relative;padding-bottom:4px;margin-bottom:2px;}
.card-head h2::after,.card-head h3::after{
  content:"";position:absolute;left:0;bottom:-2px;height:3px;width:56px;
  background:linear-gradient(90deg,var(--brand-500),var(--brand-700));
  border-radius:2px;opacity:.25;
}

/* =========================================================
   FORMS / CONTROLS / BUTTONS
   ========================================================= */
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin:12px 0;}
.grid.compact{grid-template-columns:repeat(2,1fr);}

/* Stack labels inside grids */
.grid>label,.grid.compact>label{display:flex;flex-direction:column;gap:6px;}

/* Specific layout for the Medicine block */
.grid:has(> label[for="classSelect"]){
  grid-template-columns:repeat(3,minmax(220px,1fr));
  gap:12px 20px;
}
.grid:has(> label[for="classSelect"])>label{display:flex;flex-direction:column;gap:6px;}
#classSelect,#medicineSelect,#formSelect,#startDate,#reviewDate{width:100%;}

/* Responsive collapse for the Medicine block */
@media (max-width:900px){
  .grid:has(> label[for="classSelect"]){grid-template-columns:repeat(2,minmax(220px,1fr));}
}
@media (max-width:600px){
  .grid:has(> label[for="classSelect"]){grid-template-columns:1fr;}
}

select,input,textarea{
  background:#fff;color:var(--text);
  border:1px solid var(--line);
  border-radius:10px;
  padding:10px;
  outline:none;
  transition:border-color .15s ease, box-shadow .15s ease;
}
select:focus,input:focus,textarea:focus{
  border-color:var(--brand-600);
  box-shadow:0 0 0 3px rgba(17,139,213,.18);
}

button{
  background:linear-gradient(180deg,var(--brand-500),var(--brand-600));
  color:#fff;border:none;border-radius:10px;
  padding:10px 14px;font-weight:600;cursor:pointer;
  transition:transform .05s ease, filter .15s ease;
}
button:hover{filter:brightness(1.05);}
button:active{transform:translateY(1px);}
button:focus-visible{outline:2px solid rgba(9,77,118,.35);outline-offset:2px;}
button.secondary{
  background:color-mix(in srgb,var(--brand-500) 12%,#fff 88%);
  color:var(--brand-900);
  border:1px solid var(--brand-600);
}
button.ghost{
  background:transparent;
  color:var(--brand-700);
  border:1px solid var(--brand-600);
}

.pill,.dose-lines .badge{
  background:color-mix(in srgb,var(--brand-500) 12%,#fff 88%);
  border:1px solid color-mix(in srgb,var(--brand-600) 35%,#e5e7eb 65%);
  color:var(--brand-900);
  border-radius:999px;
  padding:6px 10px;
}

.hint{color:var(--muted);margin:6px 0 0;}
.actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px;}

/* Details/Accordion: make the affordance obvious */
.accordion summary{
  display:flex;align-items:center;gap:10px;
  cursor:pointer;font-weight:700;
  padding:12px 16px;
  border-radius:10px;
  background:#dff0ff;
  border:1px solid #b7d9f7;
  user-select:none;
}
.accordion summary::-webkit-details-marker{display:none;}
.accordion summary::marker{content:"";}
.accordion summary::before{
  content:"▸";
  font-size:20px;
  width:22px;
  display:inline-block;
  transition:transform .2s ease;
}
.accordion[open] summary::before{transform:rotate(90deg);}
.accordion summary:hover{background:#d3ebff;}
.accordion summary:focus{outline:2px solid #7fb8f0;outline-offset:2px;}

/* Inline label pairs */
.taper-row{display:flex;align-items:center;flex-wrap:wrap;gap:12px 20px;margin-bottom:10px;}
.inline-label{display:inline-flex;align-items:center;gap:8px;white-space:nowrap;}

/* =========================================================
   PRODUCT PICKER (formulation bubbles)
   ========================================================= */
#productPicker{display:flex;flex-wrap:wrap;gap:6px;align-items:flex-start;}
#productPicker .checkbox{
  display:inline-flex;flex-direction:row-reverse;align-items:center;
  width:auto;padding:6px 8px;border-radius:8px;gap:8px;
  background:color-mix(in srgb,var(--brand-500) 12%,#fff 88%);
  border:1px solid var(--brand-600);
  color:var(--brand-900);
  transition:background .15s ease, border-color .15s ease;
}
#productPicker .checkbox:hover{
  background:color-mix(in srgb,var(--brand-500) 18%,#fff 82%);
}
#productPicker .checkbox:has(input:checked){
  background:color-mix(in srgb,var(--brand-500) 26%,#fff 74%);
  border-color:var(--brand-700);
}
#productPicker .checkbox input{
  transform:scale(.95);
  margin-left:6px;margin-right:0;
  accent-color:var(--brand-500);
}
#productPicker .checkbox span{
  font-size:.92rem;font-weight:500;line-height:1.15;white-space:nowrap;
}

/* =========================================================
   TABLES + OUTPUT
   ========================================================= */
.table{width:100%;border-collapse:separate;border-spacing:0 8px;}
.table thead th{font-weight:600;text-align:left;padding:8px;color:var(--brand-900);}
.table tbody td{
  background:#fff;color:var(--text);
  border:1px solid var(--border);
  padding:10px;
  vertical-align:top;
}
.table tbody tr td:first-child{border-top-left-radius:10px;border-bottom-left-radius:10px;}
.table tbody tr td:last-child{border-top-right-radius:10px;border-bottom-right-radius:10px;}

.output-head{display:flex;gap:10px;align-items:center;justify-content:space-between;margin-bottom:8px;}
.footer-notes{margin-top:12px;padding-top:8px;border-top:1px solid var(--border);}

/* render \n in instructions nicely */
.instructions-pre{white-space:pre-line;line-height:1.25;}
.tablet-icon{display:inline-block;width:18px;height:18px;object-fit:contain;margin:0 1px;vertical-align:middle;}

/* =========================================================
   FOOTER / CLASS-SPECIFIC NOTES (HTML footer block)
   ========================================================= */
.class-footer{
  font-size:.92rem;
  color:var(--text);
  line-height:1.35;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:10px;
  padding:12px 14px;
  margin-top:10px;
  white-space:normal;
}
.class-footer p{margin:0 0 .6em;}
.class-footer br{display:block;margin-top:.6em;content:"";}
.class-footer .footer-list{margin:.2em 0 .6em 1.2em;padding:0;}
.class-footer .footer-list li{margin:.2em 0;line-height:1.35;}

/* headings inside footer should be block; inline <strong> stays inline */
.class-footer > strong{
  display:block;
  color:var(--brand-900);
  font-weight:600;
  margin-top:.9em;
  margin-bottom:.3em;
}
.class-footer p strong,
.class-footer li strong{display:inline;margin:0;}

/* textarea blocks in footer */
.class-footer textarea{
  display:block;
  width:100%;
  min-height:80px;
  border:1px solid var(--border);
  border-radius:10px;
  padding:8px 10px;
  font:inherit;
  background:#fff;
  resize:vertical;
  margin-top:.4em;
  margin-bottom:.8em;
}
.class-footer em{
  display:block;
  font-size:.8rem;
  color:var(--muted);
  line-height:1.3;
  margin-top:.8em;
}
@media print{
  .class-footer strong{font-weight:700 !important;color:#000 !important;}
}

/* =========================================================
   DISCLAIMER GATE
   ========================================================= */
.hide-until-accept{display:none !important;}
#disclaimerCard .disclaimer-copy p{margin:0 0 10px;}
#disclaimerCard .inline-label{display:inline-flex;align-items:center;gap:10px;margin-top:6px;}
#disclaimerCard strong{color:var(--brand-900);}
#disclaimerCard.card{
  border:1px solid var(--brand-600);
  box-shadow:0 10px 22px rgba(17,139,213,.06),0 2px 6px rgba(0,0,0,.03);
}

/* =========================================================
   ANTIPSYCHOTIC PANEL (layout only)
   Keep ONE layout system (grid-based) to avoid conflicts.
   ========================================================= */
.ap-brief{font-size:.9rem;color:var(--muted);margin-bottom:.75rem;}
.ap-dose-grid{display:grid;gap:.5rem;max-width:480px;}
.ap-row{
  display:grid;
  grid-template-columns:1fr auto auto; /* label | input | mg */
  align-items:center;
  gap:.5rem;
}
.ap-row input{width:140px;text-align:right;}
.ap-row span:last-child{min-width:2.2rem;}
.ap-total-line{margin:.5rem 0;display:flex;align-items:center;gap:.5rem;}
.ap-total-box{padding:.2rem .5rem;border-radius:.4rem;font-weight:600;}
.ap-ok{background:#e9f7ef;color:#146c43;}
.ap-err{background:#fdecea;color:#b02a37;}

/* AP reduction-order chips */
.ap-order-label{font-size:.9rem;color:#333;margin-bottom:.25rem;}
.ap-order-chips{display:flex;gap:.6rem;flex-wrap:wrap;align-items:center;}
.ap-chip{
  display:inline-flex;align-items:center;gap:.45rem;
  padding:.45rem .7rem;
  border:1px solid #c7d2fe;
  background:linear-gradient(180deg,#eef2ff,#e0e7ff);
  border-radius:9999px;
  color:var(--text,#111827);
  font-weight:600;
  box-shadow:0 1px 1px rgba(0,0,0,.04),0 2px 8px rgba(0,0,0,.06);
  cursor:grab;user-select:none;
  transition:transform .08s ease, box-shadow .2s ease, background .2s ease, border-color .2s ease;
}
.ap-chip:active{cursor:grabbing;transform:scale(.98);background:linear-gradient(180deg,#e0e7ff,#dbeafe);border-color:#a5b4fc;}
.ap-chip:focus-visible{outline:2px solid #a5b4fc;outline-offset:2px;}
.ap-badge{
  display:inline-flex;align-items:center;justify-content:center;
  min-width:1.15rem;height:1.15rem;padding:0 .2rem;
  border-radius:9999px;background:#eef2f7;color:inherit;
  font-size:.8rem;font-weight:700;
}
#apOrder .ap-chip.dragging{opacity:.6;cursor:grabbing;}

/* =========================================================
   CALCULATIONS (optional)
   ========================================================= */
.calc-toggle{
  display:inline-flex;
  align-items:center;
  gap:6px;
  margin-left:6px;
  margin-top:4px;
  font-weight:600;
}
.calc-toggle input{transform:scale(1.15);}
#calcBlock h3{margin:0 0 8px 0;}
.calc-table{width:100%;}
.calc-table th,.calc-table td{white-space:nowrap;}
.calc-table .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;}
.calc-table .wrap{white-space:normal;}
.variance-notice{
  margin:8px 0 4px;
  padding:8px 12px;
  border-radius:6px;
  border-left:4px solid #f97316;
  background-color:#fff7ed;
  color:#7c2d12;
  font-size:.9rem;
}
#bzraSplitOptions{display:none;}

/* =========================================================
   ADVANCED SETTINGS (details accordion content styling)
   ========================================================= */
#advancedSettings{
  background-color:#d6ebf8;
  border:1px solid #b5d9f1;
  border-radius:12px;
  padding:12px 14px 14px;
  margin-top:14px;
  box-shadow:0 2px 6px rgba(0,0,0,.06);
}
#advancedSettings>summary{
  list-style:none;
  cursor:pointer;
  font-weight:700;
  color:#004b7a;
  margin:-4px -2px 6px;
}
#advancedSettings>summary::-webkit-details-marker{display:none;}
#advancedSettings>summary::marker{content:"";}
#advancedSettings>summary::after{
  content:"▾";
  margin-left:auto;
  opacity:.7;
  transition:transform .2s ease;
}
#advancedSettings[open]>summary::after{transform:rotate(180deg);}

/* Inner sub-cards only */
#advancedSettings .sub-card{
  background-color:#eaf4fb;
  border:1px solid #c6e0f2;
  border-radius:10px;
  padding:14px 16px;
  margin:10px 0;
  box-shadow:0 1px 3px rgba(0,0,0,.04);
}
#advancedSettings .sub-card p{margin:0 0 .75rem;line-height:1.55;}

/* Suggested practice readability */
.suggested-practice{
  background:#e9f4fb;
  border:1px solid #cfe6f5;
  border-radius:12px;
  padding:22px 24px;
  box-shadow:0 2px 8px rgba(0,0,0,.05);
}
.suggested-practice .practice-text{
  max-width:72ch;
  font-size:1.02rem;
  line-height:1.7;
  color:#073a53;
}
.suggested-practice h3{
  margin:0 0 .6rem;
  color:#004b7a;
  font-size:1.18rem;
  font-weight:700;
}
.suggested-practice .practice-text p{margin:0 0 .9rem;}
.suggested-practice .practice-text ul,
.suggested-practice .practice-text ol{
  margin:.2rem 0 1rem 1.25rem;
  padding:0;
  list-style:disc;
}
.suggested-practice .practice-text li{margin:.35rem 0;}
.suggested-practice .practice-text .lead{font-weight:500;color:#062f44;}
.suggested-practice .practice-text a{
  color:#005a98;
  text-decoration-thickness:2px;
  text-underline-offset:2px;
}
.suggested-practice .practice-text a:hover{color:#00406e;}
@media (max-width:480px){
  .suggested-practice{padding:18px;}
  .suggested-practice .practice-text{font-size:1rem;line-height:1.65;}
}

/* =========================================================
   RESPONSIVE (global grid fallback)
   ========================================================= */
@media (max-width:800px){
  .grid{grid-template-columns:1fr;}
  .grid.compact{grid-template-columns:1fr;}
  .actions{flex-direction:column;align-items:flex-start;}
}

/* =========================================================
   PRINT / PDF rules
   ========================================================= */
@page{size:A4 portrait;margin:16mm 12mm;}
.print-only{display:none;}

@media print{
  /* keep shading/colors exactly in print */
  html,body,#outputCard,#outputCard *{
    -webkit-print-color-adjust:exact !important;
    print-color-adjust:exact !important;
  }

  /* print just the chart card */
  body.printing .container > *{display:none !important;}
  body.printing #outputCard{display:block !important;margin:0 !important;}

  /* white page; remove app chrome/bands/shadows */
  html,body,main,.container,.card,#outputCard{
    background:#fff !important;
    color:#000 !important;
    box-shadow:none !important;
  }
  .container::before,.container::after,
  .card::before,.card::after,
  #outputCard::before,#outputCard::after{content:none !important;display:none !important;}

  .output-head{display:none !important;}
  .print-only{display:block !important;}

  /* optional injected header styling (safe to keep) */
  .print-header{margin:0 0 10pt 0;padding-bottom:6pt;border-bottom:1px solid #000;}
  .print-medline{font-size:14pt;font-weight:600;margin:0 0 2pt 0;}
  .print-instruction{font-size:10pt;margin:0 0 2pt 0;}
  .print-disclaimer{font-size:9pt;font-style:italic;margin:0 0 8pt 0;}

  /* base table shell */
  .table,.plan-table{
    width:100% !important;
    border-collapse:separate !important;
    border-spacing:0 !important;
    table-layout:auto !important;
    background:#fff !important;
  }
  .table thead{display:table-header-group !important;}
  .table tfoot{display:table-footer-group;}

  .table th,.table td,
  .plan-table th,.plan-table td{
    border:1px solid #000 !important;
    padding:6pt 8pt !important;
    background:#fff !important;
    color:#000 !important;
    white-space:pre-line;
    font-size:12px;
    vertical-align:middle;
    border-radius:0 !important;
  }

  /* Plan-table header: only bottom border */
  .plan-table thead th{
    border-width:0 0 1px 0 !important;
    border-style:solid !important;
    border-color:#000 !important;
    background:#fff !important;
    text-align:left;
  }
  .plan-table thead tr{border:0 !important;}

  /* center time-of-day columns (header + body) */
  .plan-standard thead th:nth-child(4),
  .plan-standard thead th:nth-child(5),
  .plan-standard thead th:nth-child(6),
  .plan-standard thead th:nth-child(7),
  .plan-standard td.col-am,
  .plan-standard td.col-mid,
  .plan-standard td.col-din,
  .plan-standard td.col-pm{
    text-align:center !important;
    vertical-align:middle !important;
  }
  .plan-standard td.col-am,
  .plan-standard td.col-mid,
  .plan-standard td.col-din,
  .plan-standard td.col-pm{
    font-variant-numeric:tabular-nums;
    letter-spacing:.03em;
  }

  /* === STEP BUBBLE: tablets/caps === */
  .plan-standard tbody.step-group td{border-color:transparent !important;background-clip:padding-box;}

  .plan-standard tbody.step-group tr td:first-child{border-left:1px solid #000 !important;}
  .plan-standard tbody.step-group tr td:last-child {border-right:1px solid #000 !important;}
  .plan-standard tbody.step-group tr:first-child td{border-top:1px solid #000 !important;}
  .plan-standard tbody.step-group tr:last-child  td{border-bottom:1px solid #000 !important;}
  .plan-standard tbody.step-group tr + tr td{border-top:1px solid #000 !important;}

  /* Internal verticals */
  .plan-standard tbody.step-group td.col-date,
  .plan-standard tbody.step-group td.date-spacer{border-right:0 !important;}
  .plan-standard tbody.step-group td.col-strength,
  .plan-standard tbody.step-group td.col-instr{border-left:0 !important;}
  .plan-standard tbody.step-group td.col-am,
  .plan-standard tbody.step-group td.col-mid,
  .plan-standard tbody.step-group td.col-din,
  .plan-standard tbody.step-group td.col-pm{border-left:1px solid #000 !important;}

  /* make date look merged */
  .plan-standard tbody.step-group tr + tr td.col-date{border-top:0 !important;}

  /* zebra by whole step */
  .plan-standard tbody.step-group.step-odd  td{background:#fff !important;}
  .plan-standard tbody.step-group.step-even td{background:#f2f2f2 !important;}
  #outputCard tr[data-step].zebra-even td{background:#f2f2f2 !important;}

  /* PATCH TABLE: same bubble / zebra style */
  .plan-patch tbody.step-group td{border-color:transparent !important;background-clip:padding-box;}
  .plan-patch tbody.step-group tr td:first-child{border-left:1px solid #000 !important;}
  .plan-patch tbody.step-group tr td:last-child {border-right:1px solid #000 !important;}
  .plan-patch tbody.step-group tr:first-child td{border-top:1px solid #000 !important;}
  .plan-patch tbody.step-group tr:last-child  td{border-bottom:1px solid #000 !important;}
  .plan-patch tbody.step-group tr + tr td{border-top:1px solid #000 !important;}
  .plan-patch tbody.step-group.step-odd  td{background:#fff !important;}
  .plan-patch tbody.step-group.step-even td{background:#f2f2f2 !important;}

  /* Prevent a step from splitting across pages */
  .plan-standard tbody.step-group,
  .plan-patch tbody.step-group,
  .plan-standard tbody.step-group tr,
  .plan-patch tbody.step-group tr{
    break-inside:avoid !important;
    page-break-inside:avoid !important;
  }
   /* Remove the rounded card outline in PRINT */
   body.printing #outputCard,
   body.printing #outputCard.card,
   body.printing #outputCard .card,
   body.printing .card{
  border: 0 !important;
  border-radius: 0 !important;
  box-shadow: none !important;
   }
   /* PRINT: make the taper table header look like headings (no boxed cells) */
.table thead th{
  border-width: 0 0 1px 0 !important;
  border-style: solid !important;
  border-color: #000 !important;
  background: #fff !important;
}
.table thead tr{
  border: 0 !important;
}

  /* Footer in print */
  .footer-notes,.footer-notes *{color:#000 !important;background:#fff !important;border:0 !important;}
  .footer-notes{margin-top:8pt;padding-top:6pt;border-top:1pt solid #000;}

  /* ===== Administration Record (print-only) ===== */
  .admin-record-block{
    page-break-before:always;
    margin-top:8pt;
    font-size:9pt;
  }
  .admin-month{
    page-break-after:always;
    margin-top:4pt;
  }
  .admin-month-heading{margin:0 0 2pt;font-size:11pt;font-weight:600;}
  .admin-month-note{margin:0 0 4pt;font-size:8.5pt;}

  .admin-calendar{
    width:100%;
    border-collapse:collapse;
    table-layout:fixed;
    margin-top:2pt;
  }
  .admin-calendar th,
  .admin-calendar td{
    border:1px solid #000;
    vertical-align:top;
    padding:3pt 2pt;
  }
  .admin-calendar th{
    text-align:center;
    font-size:8.5pt;
    padding-top:3pt;
    padding-bottom:3pt;
  }
  .admin-calendar td.admin-day{height:62pt;padding:4pt 3pt;}

  .day-number{font-weight:600;margin-bottom:1pt;font-size:8.5pt;}
  .dose-row{display:flex;align-items:center;gap:3pt;font-size:8pt;line-height:1.1;margin-top:1pt;}
  .admin-checkbox{flex:0 0 9pt;width:9pt;height:9pt;border:1px solid #000;box-sizing:border-box;}

  .admin-empty{background:#fafafa;}
  .admin-day-outside{background:#f2f2f2;color:#777;}

  .admin-day-step{border:1.5pt solid #000;background:#e6e6e6;}
  .admin-day-step .day-number{text-decoration:underline;}
  .step-label{margin-top:1pt;font-size:7.5pt;font-style:italic;}

  .admin-day-review{border:2px solid #000 !important;background:#d9d9d9;}
  .review-label{margin-top:1pt;font-size:7.5pt;font-style:italic;}

  /* Notes section on admin calendar pages */
  .admin-notes{margin-top:10mm;}
  .admin-notes-title{font-weight:600;font-size:10pt;margin-bottom:3mm;}
  .admin-notes-box{
    border:1px solid #000;
    height:25mm;
    background:repeating-linear-gradient(
      to bottom,
      transparent,
      transparent 6mm,
      #e0e0e0 6mm,
      #e0e0e0 6.5mm
    );
  }
}
